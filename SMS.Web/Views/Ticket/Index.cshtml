<!-- TBC change to TicketSearchViewModel -->
@model TicketSearchViewModel

<partial name="_Breadcrumbs" model=@(new [] { 
   ("/", "Home"), 
   ("/ticket", "Tickets"), 
   ("","Search") 
})>

<div class="card rounded shadow p-4">
  
<h3>Tickets</h3>

<div class="my-4 d-flex flex-row justify-content-between align-items-center">  
   <a asp-action="Create" class="btn btn-primary btn-sm">Create Ticket</a>   
   <!-- TBC add partial containing form to search ticket issues -->
  <partial name="_Search" />
</div>

<table class="table">
    <thead>
      <tr>
         <th>Id</th>
         <th>Student</th>        
         <th>Created</th> 
         <th>Issue</th> 
         <th>Active</th>   
         <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <!-- TBC - replace model with Model.Tickets -->
      @foreach(var t in Model.Tickets) {
          <tr>
            <td>@t.Id</td>
            <td>@t.Student.Name</td>
            <td>@t.CreatedOn.ToShortDateString()</td>
            <td>@t.Issue.Substring(0, t.Issue.Length < 20 ? t.Issue.Length : 20) ...</td>
            <td>
               <i asp-condition="@t.Active"    class="bi bi-toggle-on"></i>
               <i asp-condition="@(!t.Active)" class="bi bi-toggle-off"></i>  
            </td>
            <td>
               <!-- TBC - Add anchor tag to navigate to Ticket Details action -->
               <!-- this replaces the close form that was here originally -->
            </td>
         </tr>
      }
    </tbody>
</table>
</div>
